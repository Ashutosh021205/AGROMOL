{% extends 'base.html' %}
{% block content %}
<h2>Manage Locations</h2>

{% if current_user.is_admin() %}
<div class="card">
  <h3>Add New Location</h3>
  <form method="post" action="{{ url_for('manage_locations') }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
    <label>Location Name
      <input type="text" name="name" required />
    </label>
    <button type="submit">Add Location</button>
  </form>
</div>
{% endif %}

<h3>Existing Locations</h3>
{% if locations %}
<div class="table-scroll">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        {% if current_user.is_admin() %}<th>Actions</th>{% endif %}
      </tr>
    </thead>
    <tbody>
      {% for loc in locations %}
      <tr>
        <td>{{ loc.id }}</td>
        <td>{{ loc.name }}</td>
        {% if current_user.is_admin() %}
        <td class="table-actions">
          <a class="button small" href="{{ url_for('edit_location', location_id=loc.id) }}">Edit</a>
          <form method="post" action="{{ url_for('delete_location', location_id=loc.id) }}" style="display: inline;">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <button type="submit" class="button small danger" onclick="return confirm('Are you sure you want to delete this location? This action cannot be undone.')">Delete</button>
          </form>
        </td>
        {% endif %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<p>No locations added yet.</p>
{% endif %}
{% endblock %}

